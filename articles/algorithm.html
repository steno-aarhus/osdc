<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Algorithm • osdc</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Algorithm">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">osdc</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.1.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/osdc.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/algorithm.html">Algorithm</a></li>
    <li><a class="dropdown-item" href="../articles/changes.html">Changes to algorithm</a></li>
    <li><a class="dropdown-item" href="../articles/data-sources.html">Data sources</a></li>
    <li><a class="dropdown-item" href="../articles/design.html">Design</a></li>
    <li><a class="dropdown-item" href="../articles/function-flow.html">Internal function flow</a></li>
    <li><a class="dropdown-item" href="../articles/rationale.html">Rationale</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/steno-aarhus/osdc/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Algorithm</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/steno-aarhus/osdc/blob/main/vignettes/algorithm.Rmd" class="external-link"><code>vignettes/algorithm.Rmd</code></a></small>
      <div class="d-none name"><code>algorithm.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="general-description">General description<a class="anchor" aria-label="anchor" href="#general-description"></a>
</h2>
<p>A more complete description of the classifier is found in Anders
Aasted Isaksen’s <a href="https://aastedet.github.io/dissertation/" class="external-link">PhD
Thesis</a> as well as the validation paper <span class="citation">(1)</span>. The description of the algorithm below is a
brief and concise version of those documents.</p>
<p>The overall output of this algorithm is first to classify those with
diabetes, then to further classify and check if the individuals might
have type 1 diabetes, otherwise classify as type 2 diabetes.</p>
<p>The initial <strong>diabetes</strong> classification is defined as
the second occurrence of any of the listed inclusion events. Wherever
possible, all available data for each event is used, except for the
purchases of glucose-lowering drugs, since the data on obstetric
diagnoses necessary to censor glucose-lowering drug purchases is only
complete from 1997 onwards. Inclusion criteria are:</p>
<ol style="list-style-type: decimal">
<li>HbA1c measurements of ≥48 mmol/mol.</li>
<li>Hospital diagnoses of diabetes.</li>
<li>Diabetes-specific services received at podiatrist.</li>
<li>Purchase of glucose-lowering drugs.</li>
</ol>
<p>Exclusions are:</p>
<ol style="list-style-type: decimal">
<li>HbA1c samples:
<ul>
<li>Samples taken during pregnancies, as that could be a potential
gestational diabetes mellitus.</li>
</ul>
</li>
<li>Glucose-lowering drugs:
<ul>
<li>Brand drugs for weight loss, e.g. <em>Saxenda</em>.</li>
<li>Purchases during pregnancies, as that is a potential treatment for
gestational diabetes mellitus.</li>
<li>Metformin for women below age 40, as that could be a treatment for
polycystic ovary syndrome.</li>
</ul>
</li>
</ol>
<div class="section level3">
<h3 id="classifying-type-1-diabetes">Classifying type 1 diabetes<a class="anchor" aria-label="anchor" href="#classifying-type-1-diabetes"></a>
</h3>
<p>Diabetes type is classified as either T1D or T2D based on patterns of
purchases of insulin drugs (including analogues) and hospital primary
diagnoses of T1D and T2D.</p>
<p>Classification as T1D requires an individual to fulfill either of the
following criteria:</p>
<ol style="list-style-type: lower-alpha">
<li>Must have purchased only insulin drugs and never any other type of
glucose-lowering drugs, and have at least one diagnosis of T1D</li>
<li>Must have a majority of T1D diagnoses from endocrinological
departments (or from other medical departments, in the absence of
contacts to endocrinological departments), and a purchase of insulin
within 180 days after onset of diabetes, with insulin contributing at
least two thirds of all defined daily doses of glucose-lowering drugs
purchased.</li>
</ol>
<p>In populations generated on a fixed index date (such as the
cross-sectional studies associated with this dissertation), individuals
classified as T1D cases must have purchased insulin drugs in the last
year prior to the index date.</p>
</div>
<div class="section level3">
<h3 id="classifying-type-2-diabetes">Classifying type 2 diabetes<a class="anchor" aria-label="anchor" href="#classifying-type-2-diabetes"></a>
</h3>
<p>Individuals not classified as T1D cases are classified as T2D
cases.</p>
</div>
</div>
<div class="section level2">
<h2 id="detailed-and-technical-description">Detailed and technical description<a class="anchor" aria-label="anchor" href="#detailed-and-technical-description"></a>
</h2>
<p>Below are the technical, exact implementation of the above
description. These are the logical conditions and exact variables and
registers used that results in the classification of diabetes status and
types. They are shown in the form of tables for each register, as well
as for each</p>
<div class="section level3">
<h3 id="lpr_diag">
<code>lpr_diag</code><a class="anchor" aria-label="anchor" href="#lpr_diag"></a>
</h3>
<table class="table">
<colgroup>
<col width="4%">
<col width="14%">
<col width="61%">
<col width="20%">
</colgroup>
<thead><tr class="header">
<th align="left">register</th>
<th align="left">title</th>
<th align="left">logic</th>
<th align="left">comments</th>
</tr></thead>
<tbody><tr class="odd">
<td align="left">lpr_diag</td>
<td align="left">Relevant LPR2 diagnoses codes</td>
<td align="left">c_diag =~
‘^(DO0[0-6]|DO8[0-4]|DZ3[37]|DE1[0-4]|249|250)’ AND (c_diagtype == ‘A’
OR c_diagtype == ‘B’)</td>
<td align="left">‘A’ <code>c_diagtype</code> means primary
diagnosis.</td>
</tr></tbody>
</table>
</div>
<div class="section level3">
<h3 id="lpr_adm">
<code>lpr_adm</code><a class="anchor" aria-label="anchor" href="#lpr_adm"></a>
</h3>
<table class="table">
<colgroup>
<col width="4%">
<col width="14%">
<col width="19%">
<col width="60%">
</colgroup>
<thead><tr class="header">
<th align="left">register</th>
<th align="left">title</th>
<th align="left">logic</th>
<th align="left">comments</th>
</tr></thead>
<tbody><tr class="odd">
<td align="left">lpr_adm</td>
<td align="left">LPR2 endocrinology department</td>
<td align="left">na_if(c_spec, !(c_spec %in% 8:30)) == 8</td>
<td align="left">
<code>TRUE</code> when the department is endocrinology,
<code>FALSE</code> when it is other medical departments, and missing is
all other cases.</td>
</tr></tbody>
</table>
</div>
<div class="section level3">
<h3 id="diagnoser">
<code>diagnoser</code><a class="anchor" aria-label="anchor" href="#diagnoser"></a>
</h3>
<table class="table">
<colgroup>
<col width="3%">
<col width="10%">
<col width="51%">
<col width="35%">
</colgroup>
<thead><tr class="header">
<th align="left">register</th>
<th align="left">title</th>
<th align="left">logic</th>
<th align="left">comments</th>
</tr></thead>
<tbody><tr class="odd">
<td align="left">diagnoser</td>
<td align="left">Relevant LPR3 diagnoses codes</td>
<td align="left">diagnosekode =~ ‘^(DO0[0-6]|DO8[0-4]|DZ3[37]|DE1[0-4])’
AND (diagnosetype == ‘A’ OR diagnosetype == ‘B’) AND (senere_afkraeftet
== ‘Nej’)</td>
<td align="left">
<code>A</code> <code>diagnosekode</code> means primary
diagnosis and <code>senere_afkraeftet</code> means diagnosis was later
retracted.</td>
</tr></tbody>
</table>
</div>
<div class="section level3">
<h3 id="kontakter">
<code>kontakter</code><a class="anchor" aria-label="anchor" href="#kontakter"></a>
</h3>
<table class="table">
<colgroup>
<col width="1%">
<col width="4%">
<col width="73%">
<col width="19%">
</colgroup>
<thead><tr class="header">
<th align="left">register</th>
<th align="left">title</th>
<th align="left">logic</th>
<th align="left">comments</th>
</tr></thead>
<tbody><tr class="odd">
<td align="left">kontakter</td>
<td align="left">LPR3 endocrinology department</td>
<td align="left">na_if(hovedspeciale_ans, !(hovedspeciale_ans %in%
c(‘medicinsk endokrinologi’, ‘blandet medicin og kirurgi’, ‘intern
medicin’, ‘geriatri’, ‘hepatologi’, ‘hæmatologi’, ‘infektionsmedicin’,
‘kardiologi’, ‘medicinsk allergologi’, ‘medicinsk gastroenterologi’,
‘medicinsk lungesygdomme’, ‘nefrologi’, ‘reumatologi’, ‘palliativ
medicin’, ‘akut medicin’, ‘dermato-venerologi’, ‘neurologi’, ‘onkologi’,
‘fysiurgi’, ‘tropemedicin’))) == ‘medicinsk endokrinologi’</td>
<td align="left">
<code>TRUE</code> when the department is endocrinology,
<code>FALSE</code> when it is other medical departments, and missing in
all other cases.</td>
</tr></tbody>
</table>
</div>
<div class="section level3">
<h3 id="lab_forsker">
<code>lab_forsker</code><a class="anchor" aria-label="anchor" href="#lab_forsker"></a>
</h3>
<table class="table">
<colgroup>
<col width="6%">
<col width="8%">
<col width="51%">
<col width="32%">
</colgroup>
<thead><tr class="header">
<th align="left">register</th>
<th align="left">title</th>
<th align="left">logic</th>
<th align="left">comments</th>
</tr></thead>
<tbody><tr class="odd">
<td align="left">lab_forsker</td>
<td align="left">HbA1c inclusion</td>
<td align="left">(analysiscode == ‘NPU27300’ AND value &gt;= 48) OR
(analysiscode == ‘NPU03835’ AND value &gt;= 6.5)</td>
<td align="left">Is the IFCC units for NPU27300 and DCCT units for
NPU03835.</td>
</tr></tbody>
</table>
</div>
<div class="section level3">
<h3 id="ssyi-and-sssy-for-podiatrist-services">
<code>ssyi</code> and <code>sssy</code> for podiatrist services<a class="anchor" aria-label="anchor" href="#ssyi-and-sssy-for-podiatrist-services"></a>
</h3>
<table class="table">
<colgroup>
<col width="6%">
<col width="14%">
<col width="25%">
<col width="53%">
</colgroup>
<thead><tr class="header">
<th align="left">register</th>
<th align="left">title</th>
<th align="left">logic</th>
<th align="left">comments</th>
</tr></thead>
<tbody><tr class="odd">
<td align="left">NA</td>
<td align="left">Podiatrist services</td>
<td align="left">speciale =~ ‘^54’ AND barnmak != 0</td>
<td align="left">
<code>barnmak</code> means the services were provided
to a child of the individual.</td>
</tr></tbody>
</table>
</div>
<div class="section level3">
<h3 id="lmdb-for-glucose-lowering-drugs">
<code>lmdb</code> for glucose lowering drugs<a class="anchor" aria-label="anchor" href="#lmdb-for-glucose-lowering-drugs"></a>
</h3>
<table class="table">
<colgroup>
<col width="5%">
<col width="19%">
<col width="39%">
<col width="35%">
</colgroup>
<thead><tr class="header">
<th align="left">register</th>
<th align="left">title</th>
<th align="left">logic</th>
<th align="left">comments</th>
</tr></thead>
<tbody><tr class="odd">
<td align="left">lmdb</td>
<td align="left">Glucose-lowering drug inclusion</td>
<td align="left">atc =~ ‘^A10’ AND !(atc =~
‘^(A10BJ|A10BK01|A10BK03)’)</td>
<td align="left">Do not keep GLP-RAs or dapagliflozin/empagliflozin
drugs.</td>
</tr></tbody>
</table>
</div>
<div class="section level3">
<h3 id="bef-and-only-gld-via-lmdb-for-potential-polycystic-ovary-syndrome">
<code>bef</code> and only GLD (via <code>lmdb</code>) for potential
polycystic ovary syndrome<a class="anchor" aria-label="anchor" href="#bef-and-only-gld-via-lmdb-for-potential-polycystic-ovary-syndrome"></a>
</h3>
<table class="table">
<colgroup>
<col width="4%">
<col width="9%">
<col width="67%">
<col width="18%">
</colgroup>
<thead><tr class="header">
<th align="left">register</th>
<th align="left">title</th>
<th align="left">logic</th>
<th align="left">comments</th>
</tr></thead>
<tbody><tr class="odd">
<td align="left">NA</td>
<td align="left">No potential PCOS</td>
<td align="left">koen == 2 AND atc =~ ‘^A10BA02$’ AND ((date -
foed_dato) &lt; 40 OR indication_code %in% c(‘0000092’, ‘0000276’,
‘0000781’))</td>
<td align="left">Woman is defined as 2 in <code>koen</code>.</td>
</tr></tbody>
</table>
</div>
<div class="section level3">
<h3 id="pregnancy-events">Pregnancy events<a class="anchor" aria-label="anchor" href="#pregnancy-events"></a>
</h3>
<table class="table">
<colgroup>
<col width="4%">
<col width="24%">
<col width="67%">
<col width="4%">
</colgroup>
<thead><tr class="header">
<th align="left">register</th>
<th align="left">title</th>
<th align="left">logic</th>
<th align="left">comments</th>
</tr></thead>
<tbody><tr class="odd">
<td align="left">NA</td>
<td align="left">Remove events within a potential pregnancy period</td>
<td align="left">!(has_pregnancy_event AND has_elevated_hba1c AND (date
&gt;= (pregnancy_event_date - weeks(40)) OR date &lt;=
(pregnancy_event_date + weeks(12)))</td>
<td align="left"></td>
</tr></tbody>
</table>
</div>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body">
<div id="ref-Isaksen2023" class="csl-entry">
<div class="csl-left-margin">1. </div>
<div class="csl-right-inline">Isaksen AA, Sandbæk A, Bjerg L. <a href="https://doi.org/10.2147/clep.s407019" class="external-link">Validation of register-based
diabetes classifiers in danish data</a>. Clinical Epidemiology. 2023
May;Volume 15:569–81. </div>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Luke William Johnston, Signe Kirk Brødbæk, Anders Aasted Isaksen.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
